"use strict";function bindingConfig(e){var t=currentOperation(e.env),n={oper:t,env:e.env,globals:e.globals||{},option:e.option,runTasks:e.runTasks,fileFilter:utils_1.files,runSequence:taskSequence_1.runSequence,addToSequence:e.addToSequence||function(e,t){return taskSequence_1.addToSequence(e,t,n)},generateTask:function(e,t){return generateTask_1.generateTask(e,_.extend(createDefaultMatch(n),t||{}))},findTasks:function(e,t){return decorator_1.findTasksInModule(e,_.extend(createDefaultMatch(n),t||{}))},findTasksInDir:function(e,t){return decorator_1.findTasksInDir(e,_.extend(createDefaultMatch(n),t||{}))},findTaskDefine:decorator_1.findTaskDefineInModule.bind(this),findTaskDefineInDir:decorator_1.findTaskDefineInDir.bind(this),subTaskName:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i="";_.isString(t)?i=t:t&&t!==n.option&&(t.name&&(i=utils_1.taskStringVal(t.name,n)),!i&&t.assert&&t.assert.name&&(i=utils_1.taskStringVal(t.assert.name,n)));var a=utils_1.taskStringVal(e.option.name,n);return a?0===i.indexOf(a+"-")?i:i&&a!==i?a+"-"+i+r:a+r:i+r},getSrc:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=void 0,a=t?t.oper||n.oper:n.oper;return t&&t.assert&&(i=utils_1.taskSourceVal(getAssertSrc(t.assert,a),n)),i||(i=utils_1.taskSourceVal(getAssertSrc(e.option,a),n)),r!==!1?i:utils_1.absoluteSrc(e.env.root,i)},getDist:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=void 0;return t&&t.assert&&(i=getCurrentDist(t.assert,n)),i=i||getCurrentDist(n.option,n),r!==!1?i:utils_1.absolutePath(e.env.root,i)},toRootSrc:function(t){return utils_1.absoluteSrc(e.env.root,t)},toRootPath:function(t){return utils_1.absolutePath(e.env.root,t)},toDistPath:function(e){return utils_1.absolutePath(n.getDist(),e)}};return n}function currentOperation(e){var t=void 0;return t=e.deploy?TaskConfig_1.Operation.deploy:e.release?TaskConfig_1.Operation.release:TaskConfig_1.Operation.build,e.watch&&(t|=TaskConfig_1.Operation.watch),e.test&&(t|=TaskConfig_1.Operation.test),e.serve&&(t|=TaskConfig_1.Operation.serve),e.e2e&&(t|=TaskConfig_1.Operation.e2e),t}function getAssertSrc(e,t){var n=null;return(t&TaskConfig_1.Operation.test)>0?n=e.testSrc:(t&TaskConfig_1.Operation.e2e)>0?n=e.e2eSrc:(t&TaskConfig_1.Operation.watch)>0?n=e.watchSrc:(t&TaskConfig_1.Operation.clean)>0&&(n=e.cleanSrc||e.dist),n||e.src}function getCurrentDist(e,t){var n=void 0,r=t.env,i=t.oper;return r.deploy||(i&TaskConfig_1.Operation.deploy)>0?n=e.deployDist||utils_1.taskStringVal(e.dist,t):r.release||(i&TaskConfig_1.Operation.release)>0?n=e.releaseDist||utils_1.taskStringVal(e.dist,t):r.e2e||(i&TaskConfig_1.Operation.e2e)>0?n=e.e2eDist||e.buildDist||utils_1.taskStringVal(e.dist,t):r.test||(i&TaskConfig_1.Operation.test)>0?n=e.testDist||e.buildDist||utils_1.taskStringVal(e.dist,t):(i&TaskConfig_1.Operation.build)>0&&(n=e.buildDist||utils_1.taskStringVal(e.dist,t)),n}var _=require("lodash"),TaskConfig_1=require("./TaskConfig"),generateTask_1=require("./generateTask"),taskSequence_1=require("./taskSequence"),utils_1=require("./utils"),decorator_1=require("./decorator");exports.bindingConfig=bindingConfig;var createDefaultMatch=function(e){var t={oper:e.oper};return e.match&&(t.match=function(n){return e.match(t,n)}),t};exports.currentOperation=currentOperation;
//# sourceMappingURL=sourcemaps/bindingConfig.js.map
