"use strict";function bindingConfig(e){var t=(e.oper||0)|currentOperation(e.env),r={oper:t,env:e.env,globals:e.globals||{},option:e.option,runTasks:e.runTasks,fileFilter:utils_1.files,runSequence:taskSequence_1.runSequence,addToSequence:e.addToSequence||taskSequence_1.addToSequence,generateTask:function(e,t){return generateTask_1.generateTask(e,_.extend(createDefaultMatch(r),t||{}))},findTasks:function(e,t){return decorator_1.findTasksInModule(e,_.extend(createDefaultMatch(r),t||{}))},findTasksInDir:function(e,t){return decorator_1.findTasksInDir(e,_.extend(createDefaultMatch(r),t||{}))},findTaskDefine:decorator_1.findTaskDefineInModule.bind(this),findTaskDefineInDir:decorator_1.findTaskDefineInDir.bind(this),subTaskName:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i="";if(_.isString(t))i=t;else if(t&&t!==r.option){var a=t.name;a||(a=t.assert?t.assert.name:""),i=utils_1.taskStringVal(a,r.oper,e.env)}else i=n;var s=utils_1.taskStringVal(e.option.name,r.oper,e.env);return s?s+"-"+i:i},getSrc:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=void 0,a=t?t.oper||r.oper:r.oper;return t&&t.assert&&(i=utils_1.taskSourceVal(getAssertSrc(t.assert,a),r.oper,e.env)),i||(i=utils_1.taskSourceVal(getAssertSrc(e.option,a),r.oper,e.env)),n!==!1?i:utils_1.absoluteSrc(e.env.root,i)},getDist:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=void 0;return t&&t.assert&&(i=getCurrentDist(t.assert,r.oper,e.env)),i=i||getCurrentDist(r.option,r.oper,e.env),n!==!1?i:utils_1.absolutePath(e.env.root,i)},toRootSrc:function(t){return utils_1.absoluteSrc(e.env.root,t)},toRootPath:function(t){return utils_1.absolutePath(e.env.root,t)}};return r}function currentOperation(e){var t=void 0;return t=e.deploy?TaskConfig_1.Operation.deploy:e.release?TaskConfig_1.Operation.release:TaskConfig_1.Operation.build,e.watch&&(t|=TaskConfig_1.Operation.watch),e.test&&(t|=TaskConfig_1.Operation.test),e.serve&&(t|=TaskConfig_1.Operation.serve),e.e2e&&(t|=TaskConfig_1.Operation.e2e),t}function getAssertSrc(e,t){var r=null;return(t&TaskConfig_1.Operation.test)>0?r=e.testSrc:(t&TaskConfig_1.Operation.e2e)>0?r=e.e2eSrc:(t&TaskConfig_1.Operation.watch)>0?r=e.watchSrc:(t&TaskConfig_1.Operation.clean)>0&&(r=e.cleanSrc||e.dist),r||e.src}function getCurrentDist(e,t,r){var n=void 0;return r.deploy||(t&TaskConfig_1.Operation.deploy)>0?n=e.deployDist||utils_1.taskStringVal(e.dist,t,r):r.release||(t&TaskConfig_1.Operation.release)>0?n=e.releaseDist||utils_1.taskStringVal(e.dist,t,r):r.e2e||(t&TaskConfig_1.Operation.e2e)>0?n=e.e2eDist||e.buildDist||utils_1.taskStringVal(e.dist,t,r):r.test||(t&TaskConfig_1.Operation.test)>0?n=e.testDist||e.buildDist||utils_1.taskStringVal(e.dist,t,r):(t&TaskConfig_1.Operation.build)>0&&(n=e.buildDist||utils_1.taskStringVal(e.dist,t,r)),n}var _=require("lodash"),TaskConfig_1=require("./TaskConfig"),generateTask_1=require("./generateTask"),taskSequence_1=require("./taskSequence"),utils_1=require("./utils"),decorator_1=require("./decorator");exports.bindingConfig=bindingConfig;var createDefaultMatch=function(e){var t={oper:e.oper};return e.match&&(t.match=function(r){return e.match(t,r)}),t};exports.currentOperation=currentOperation;
//# sourceMappingURL=sourcemaps/bindingConfig.js.map
