"use strict";function sortOrder(r,e,t,n){void 0===n&&(n=!1);var o={};r=_.filter(r,function(r){return!!r});var i=_.orderBy(r,function(i){if(_.isArray(i))return.5;var a=e(i);_.isFunction(a)&&(a=a(r.length,t));var u=void 0;return _.isNumber(a)?u=a:a?(a.value=_.isNumber(a.value)?a.value:.5,n||a.runWay!==TaskConfig_1.RunWay.parallel||(o[a.value]=o[a.value]||[],o[a.value].push(i)),u=a.value):u=.5,u>1?u%r.length/r.length:(u<0&&(u=0),u)});return n||_.each(_.values(o),function(r){var e=_.first(r);i.splice(i.indexOf(e),r.length,r)}),i}function contains(r,e){return e.some(function(e){return r.indexOf(e)>=0})}function convertOper(r,e){return void 0===e&&(e=TaskConfig_1.Operation.default),r=r||{},r.oper=r.oper||e,r}function convertMatchOper(r,e){var t=r.to(e.oper);return t&TaskConfig_1.Operation.test&&!(t&TaskConfig_1.Operation.release)&&(t|=TaskConfig_1.Operation.build),t&TaskConfig_1.Operation.e2e&&!(t&TaskConfig_1.Operation.release)&&(t|=TaskConfig_1.Operation.build),t&TaskConfig_1.Operation.deploy&&(t=t|TaskConfig_1.Operation.test|TaskConfig_1.Operation.e2e),t&TaskConfig_1.Operation.release&&(t|=TaskConfig_1.Operation.test),e.oper=t,e}function someOper(r,e){return(r&e)>0}function matchCompare(r,e,t){return!!matchTaskInfo(r,e,t)&&!!matchTaskGroup(e,t)}function matchTaskInfo(r,e,t){if(t=convertOper(t,TaskConfig_1.Operation.build),e=convertOper(e),t.match)return t.match(e);if(e.match)return e.match(t);t=convertMatchOper(r,t);var n=r.to(e.oper),o=r.to(t.oper),i=n&o;if(i<=0)return!1;if(n&TaskConfig_1.Operation.watch){if((o&TaskConfig_1.Operation.watch)<=0)return!1;if(i<=TaskConfig_1.Operation.watch)return!1}if(n&TaskConfig_1.Operation.serve){if(!(o&TaskConfig_1.Operation.serve))return!1;if(i<=TaskConfig_1.Operation.serve)return!1}if(n&TaskConfig_1.Operation.test){if(!(o&TaskConfig_1.Operation.test))return!1;if(i<=TaskConfig_1.Operation.test)return!1}if(n&TaskConfig_1.Operation.e2e){if(!(o&TaskConfig_1.Operation.e2e))return!1;if(i<=TaskConfig_1.Operation.e2e)return!1}return!0}function matchTaskGroup(r,e){if(r.group&&e&&e.group){if(_.isString(e.group)){if(_.isString(r.group)&&r.group!==e.group)return!1;if(_.isArray(r.group)&&r.group.indexOf(e.group)<0)return!1}else if(_.isArray(e.group)){if(_.isString(r.group)&&e.group.indexOf(r.group)<0)return!1;if(_.isArray(r.group)&&!contains(r.group,e.group))return!1}}else{if(r.group)return!1;if(e&&e.group)return!1}return!0}function absolutePath(r,e){return!r||path.isAbsolute(e)?e:path.join(r,e)}function absoluteSrc(r,e){return _.isString(e)?prefixSrc(r,e):_.map(e,function(e){return prefixSrc(r,e)})}function prefixSrc(r,e){var t="";return/^!/.test(e)&&(t="!",e=e.substring(1,e.length)),t+absolutePath(r,e)}Object.defineProperty(exports,"__esModule",{value:!0});var _=require("lodash"),TaskConfig_1=require("./TaskConfig"),path=require("path");exports.sortOrder=sortOrder,exports.convertOper=convertOper,exports.someOper=someOper,exports.matchCompare=matchCompare,exports.absolutePath=absolutePath,exports.absoluteSrc=absoluteSrc;
//# sourceMappingURL=sourcemaps/utils.js.map
