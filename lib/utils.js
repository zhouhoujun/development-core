"use strict";function sortOrder(r,e,o,t){void 0===t&&(t=!1);var n={},i=_.orderBy(_.filter(r,function(r){return r}),function(i){if(_.isArray(i))return.5;var a=e(i);_.isFunction(a)?a=a(r.length,o):_.isNumber(a)||a||(a=.5);var p=void 0;return _.isNumber(a)?p=a:(t||a.runWay!==TaskConfig_1.RunWay.parallel||(n[a.value]=n[a.value]||[],n[a.value].push(i)),p=a.value),p>1?p%r.length/r.length:(p<0&&(p=0),p)});return t||_.each(_.values(n),function(r){var e=_.first(r);i.splice(i.indexOf(e),r.length,r)}),i}function contains(r,e){return e.some(function(e){return r.indexOf(e)>=0})}function convertOper(r,e){return void 0===e&&(e=TaskConfig_1.Operation.default),r=r||{},r.oper=r.oper||e,r}function convertMatchOper(r){return r.oper&TaskConfig_1.Operation.test&&!(r.oper&TaskConfig_1.Operation.release)&&(r.oper=r.oper|TaskConfig_1.Operation.build),r.oper&TaskConfig_1.Operation.e2e&&!(r.oper&TaskConfig_1.Operation.release)&&(r.oper=r.oper|TaskConfig_1.Operation.build),r.oper&TaskConfig_1.Operation.deploy&&(r.oper=r.oper|TaskConfig_1.Operation.test|TaskConfig_1.Operation.e2e),r.oper&TaskConfig_1.Operation.release&&(r.oper=r.oper|TaskConfig_1.Operation.test),r}function someOper(r,e){return(r&e)>0}function matchCompare(r,e,o){return o?o.matchCompare(r,e):!!matchTaskInfo(r,e)&&!!matchTaskGroup(r,e)}function matchTaskInfo(r,e){if(e=convertOper(e,TaskConfig_1.Operation.build),r=convertOper(r),e.match)return e.match(r);if(r.match)return r.match(e);e=convertMatchOper(e);var o=r.oper&e.oper;if(o<=0)return!1;if(r.oper&TaskConfig_1.Operation.watch){if((e.oper&TaskConfig_1.Operation.watch)<=0)return!1;if(o<=TaskConfig_1.Operation.watch)return!1}if(r.oper&TaskConfig_1.Operation.serve){if(!(e.oper&TaskConfig_1.Operation.serve))return!1;if(o<=TaskConfig_1.Operation.serve)return!1}if(r.oper&TaskConfig_1.Operation.test){if(!(e.oper&TaskConfig_1.Operation.test))return!1;if(o<=TaskConfig_1.Operation.test)return!1}if(r.oper&TaskConfig_1.Operation.e2e){if(!(e.oper&TaskConfig_1.Operation.e2e))return!1;if(o<=TaskConfig_1.Operation.e2e)return!1}return!0}function matchTaskGroup(r,e){if(r.group&&e&&e.group){if(_.isString(e.group)){if(_.isString(r.group)&&r.group!==e.group)return!1;if(_.isArray(r.group)&&r.group.indexOf(e.group)<0)return!1}else if(_.isArray(e.group)){if(_.isString(r.group)&&e.group.indexOf(r.group)<0)return!1;if(_.isArray(r.group)&&!contains(r.group,e.group))return!1}}else{if(r.group)return!1;if(e&&e.group)return!1}return!0}function absolutePath(r,e){return!r||path.isAbsolute(e)?e:path.join(r,e)}function absoluteSrc(r,e){return _.isString(e)?prefixSrc(r,e):_.map(e,function(e){return prefixSrc(r,e)})}function prefixSrc(r,e){var o="";return/^!/.test(e)&&(o="!",e=e.substring(1,e.length)),o+absolutePath(r,e)}Object.defineProperty(exports,"__esModule",{value:!0});var _=require("lodash"),TaskConfig_1=require("./TaskConfig"),path=require("path");exports.sortOrder=sortOrder,exports.convertOper=convertOper,exports.someOper=someOper,exports.matchCompare=matchCompare,exports.absolutePath=absolutePath,exports.absoluteSrc=absoluteSrc;
//# sourceMappingURL=sourcemaps/utils.js.map
